import{J as z}from"./DialogModal.13bcfa5f.js";import{J as C}from"./ActionMessage.59b94243.js";import{_ as k,r as l,o as u,J as O,b as o,w as n,d as c,N as j,Q,U as x,a as i,O as U,a8 as A,c as a,M as p,L as v}from"./app.9dc34ef4.js";import{r as D}from"./PlusIcon.268dbb20.js";import N from"./ProductHoldView.e5aa2833.js";import F from"./InventoryDetail.dcd1fea5.js";import J from"./ItemConfirmQuantity.c447e026.js";import{S as B,a as L,b as M,c as K}from"./switch.esm.c16c42ce.js";import"./Modal.c8b704a0.js";import"./TabLink.8aaa87cf.js";import"./ErrorMessage.e1cd30fd.js";import"./XCircleIcon.615c78c3.js";import"./ProductHoldItem.5681089d.js";import"./SmallLineItem.a2a9a34f.js";import"./LoadingState.731eb4ed.js";import"./ConfirmationModal.47b3bac6.js";import"./description.esm.f365edce.js";import"./label.esm.2a39737d.js";const T={components:{Switch:B,SwitchDescription:L,SwitchGroup:M,SwitchLabel:K,JetActionMessage:C,JetDialogModal:z,PlusIcon:D,ProductHoldView:N,InventoryDetail:F,ItemConfirmQuantity:J},props:{order:Object},data(){var r,t;return{priceLevelId:(t=(r=this.$page.props.order)==null?void 0:r.customer)==null?void 0:t.customer_price_level_id,addAnother:!0,products:this.$page.props.products,sizes:this.$page.props.sizes,selectedProduct:null,selectedSize:null,creatingOrderItem:!1,availableForSale:0,confirmingQuantity:!1,confirmedQuantity:!1,form:this.$inertia.form({_method:"POST",product_id:null,size_id:null,original_quantity:null,quantity:null,unit_price:null,no_discount:!1})}},watch:{selectedProduct(r){r?this.form.product_id=r.id:this.form.product_id=null,this.getProductPrice()},"form.original_quantity"(r){this.form.quantity=r},selectedSize(r){r?this.form.size_id=r.id:this.form.size_id=null,this.getProductPrice()}},methods:{getProductPrice(){this.selectedProduct&&this.selectedSize?axios.get(route("api.product.prices",[this.selectedProduct.id,this.selectedSize.id])).then(r=>{let t=r.data.find(_=>_.price_level_id==this.priceLevelId).price;this.form.unit_price=t}):this.form.unit_price=0},updateQuantity(r){this.availableForSale=r.availableForSale},viewInventory(r){this.showPopup(route("view.show",{id:r.id}),"View Inventory")},saveAndClose(){this.addAnother=!1,this.createOrderItem()},confirmed(){this.confirmingQuantity=!1,this.confirmedQuantity=!0,this.create()},createOrderItem(){this.form.quantity>this.availableForSale?this.confirmingQuantity=!0:this.confirmed()},create(){this.form.post(route("sales.order-items.store",this.order),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{this.form.reset(),this.selectedSize=null,this.selectedProduct=null,this.addAnother==!1&&(this.creatingOrderItem=!1)}})}}},E=c("New Order Item"),G=c("View Inventory"),H={class:"grid md:grid-cols-6 gap-4"},W={class:"grid gap-4"},R={class:"grid gap-4 sm:grid-cols-2"},X={class:"sm:col-span-2 min-w-0"},Y={class:"sm:col-span-1"},Z={class:"sm:col-span-1 flex items-center mt-4"},$=c("Don't apply Discount?"),ee={class:"grid gap-4 grid-cols-1 sm:grid-cols-3"},te={class:"sm:col-span-1"},oe={class:"sm:col-span-1"},se={class:"sm:col-span-1"},re={class:"flex justify-between items-center w-full"},ie=c("Cancel"),le=c("Save and add another Item"),ne=c("Save and Close");function de(r,t,_,ce,e,d){const b=l("PlusIcon"),f=l("jet-button"),g=l("select-box"),m=l("jet-input-error"),I=l("jet-checkbox"),y=l("jet-label"),w=l("InventoryDetail"),h=l("jet-input"),S=l("product-hold-view"),P=l("jet-secondary-button"),V=l("jet-dialog-modal"),q=l("ItemConfirmQuantity");return u(),O("div",null,[o(f,{type:"button",onClick:t[0]||(t[0]=s=>e.creatingOrderItem=!0)},{default:n(()=>[o(b,{class:"w-4 h-4 mr-2"}),E]),_:1}),o(V,{maxWidth:"4xl",show:e.creatingOrderItem,onClose:t[11]||(t[11]=s=>e.creatingOrderItem=!1)},{title:n(()=>[c("Add a product or service to "+j(_.order.type)+".",1)]),aside:n(()=>[Q(o(f,{onClick:t[1]||(t[1]=s=>d.viewInventory(e.selectedProduct))},{default:n(()=>[G]),_:1},512),[[x,e.selectedProduct]])]),content:n(()=>[i("div",H,[i("form",{onSubmit:t[8]||(t[8]=U((...s)=>d.createOrderItem&&d.createOrderItem(...s),["prevent"])),onKeydown:t[9]||(t[9]=A((...s)=>d.createOrderItem&&d.createOrderItem(...s),["enter"])),class:"md:col-span-4"},[i("div",W,[i("div",R,[i("div",X,[o(g,{labelValue:"Product",items:e.products,selectedItem:e.selectedProduct,modelValue:e.selectedProduct,"onUpdate:modelValue":t[2]||(t[2]=s=>e.selectedProduct=s)},null,8,["items","selectedItem","modelValue"]),e.form.product_id?p("",!0):(u(),a(m,{key:0,message:e.form.errors.product_id,class:"mt-2"},null,8,["message"]))]),i("div",Y,[o(g,{labelValue:"Size",items:e.sizes,selectedItem:e.selectedSize,modelValue:e.selectedSize,"onUpdate:modelValue":t[3]||(t[3]=s=>e.selectedSize=s)},null,8,["items","selectedItem","modelValue"]),e.form.size_id?p("",!0):(u(),a(m,{key:0,message:e.form.errors.size_id,class:"mt-2"},null,8,["message"])),i("div",Z,[o(I,{id:"no_discount",modelValue:e.form.no_discount,"onUpdate:modelValue":t[4]||(t[4]=s=>e.form.no_discount=s),class:"mr-2"},null,8,["modelValue"]),o(y,{for:"no_discount"},{default:n(()=>[$]),_:1})])]),o(w,{onUpdate:d.updateQuantity,product:e.selectedProduct,size:e.selectedSize},null,8,["onUpdate","product","size"])]),i("div",ee,[i("div",te,[o(y,{for:"original_quantity",value:"Quantity Ordered"}),o(h,{id:"original_quantity",type:"number",step:"1",class:"mt-1 block w-full",modelValue:e.form.original_quantity,"onUpdate:modelValue":t[5]||(t[5]=s=>e.form.original_quantity=s),required:""},null,8,["modelValue"]),e.form.original_quantity?p("",!0):(u(),a(m,{key:0,message:e.form.errors.original_quantity,class:"mt-2"},null,8,["message"]))]),i("div",oe,[o(y,{for:"quantity",value:"Quantity Confirmed"}),o(h,{id:"quantity",type:"number",step:"1",class:"mt-1 block w-full",modelValue:e.form.quantity,"onUpdate:modelValue":t[6]||(t[6]=s=>e.form.quantity=s),required:""},null,8,["modelValue"]),e.form.quantity?p("",!0):(u(),a(m,{key:0,message:e.form.errors.quantity,class:"mt-2"},null,8,["message"]))]),i("div",se,[o(y,{for:"unit_price",value:"Unit Price"}),o(h,{id:"unit_price",type:"number",step:"0.01",class:"mt-1 block w-full",modelValue:e.form.unit_price,"onUpdate:modelValue":t[7]||(t[7]=s=>e.form.unit_price=s),required:""},null,8,["modelValue"]),e.form.unit_price?p("",!0):(u(),a(m,{key:0,message:e.form.errors.unit_price,class:"mt-2"},null,8,["message"]))])])])],32),o(S,{class:"md:col-span-2",orderId:_.order.id,product:e.selectedProduct,size:e.selectedSize},null,8,["orderId","product","size"])])]),footer:n(()=>[i("div",re,[o(P,{type:"button",onClick:t[10]||(t[10]=s=>e.creatingOrderItem=!1)},{default:n(()=>[ie]),_:1}),i("div",null,[o(f,{type:"submit",onClick:d.createOrderItem,class:v([{"opacity-25":e.form.processing}," mb-2 sm:mb-0 sm:mr-2"]),disabled:e.form.processing},{default:n(()=>[le]),_:1},8,["onClick","class","disabled"]),o(f,{type:"submit",onClick:d.saveAndClose,class:v({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:n(()=>[ne]),_:1},8,["onClick","class","disabled"])])])]),_:1},8,["show"]),o(q,{selectedProduct:e.selectedProduct,quantity:e.form.quantity,quantityAvailable:e.availableForSale,show:e.confirmingQuantity,onQuantityConfirmed:d.confirmed},null,8,["selectedProduct","quantity","quantityAvailable","show","onQuantityConfirmed"])])}var Ce=k(T,[["render",de]]);export{Ce as default};
