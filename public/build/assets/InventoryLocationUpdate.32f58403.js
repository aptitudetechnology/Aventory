import{P as j}from"./PencilIcon.a5057f93.js";import{N,r as d,o as s,t as m,a as l,b as a,w as i,x as f,v as p,d as c,A as w,U as x,u as L,c as b,y as J,I as R}from"./app.c6d51eb6.js";import{J as A}from"./Button.9edbaae6.js";import{J as S}from"./Label.98bc58ad.js";import{J as T}from"./InputError.871a3d35.js";import{J as U}from"./Checkbox.28af1d52.js";import{J as E}from"./SecondaryButton.d03b45d1.js";import{J as M}from"./DialogModal.15f17e82.js";import{J as O}from"./ConfirmationModal.08e30afa.js";import{S as K}from"./SelectBox.4394748c.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import"./Modal.a8ddeb0e.js";import"./SectionTitle.6e9e4bb1.js";import"./dom.esm.fa0fef86.js";import"./calculate-active-index.esm.611fafbc.js";import"./use-resolve-button-type.esm.4623ef0e.js";const{createVNode:q,openBlock:z,createBlock:H}=N;var Y=function(e,n){return z(),H("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[q("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})])};const{createVNode:F,openBlock:G,createBlock:Q}=N;var X=function(e,n){return G(),Q("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[F("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])};const Z={components:{ChevronLeftIcon:Y,ChevronRightIcon:X,JetDialogModal:M,JetConfirmationModal:O,EditIcon:j,JetInputError:T,JetLabel:S,JetCheckbox:U,JetButton:A,JetSecondaryButton:E,SelectBox:K},props:{inventory:Object},data(){return{loading:!1,locationData:{nextPlace:null,previousPlace:null,autoLocate:!0,autoLocateToNext:!0},autoLocateNotice:{wasAutoLocated:!0,message:null},confirmingReplace:!1,editingInventoryLocation:!1,selectedBlock:this.inventory.block,blocks:this.$page.props.blocks,row:this.inventory.place?{name:this.inventory.place.row_number}:null,place:this.inventory.place,places:[],form:this.$inertia.form({block_id:this.inventory.block_id,place_id:this.inventory.place_id,confirm_replace:null})}},watch:{locationData:{handler(t){localStorage.setItem("locationData",JSON.stringify(t))},deep:!0},selectedBlock(t){t?(this.form.block_id=t.id,this.row=null,this.getPlaces(t)):this.form.block_id=null},row(t){var e;((e=this.place)==null?void 0:e.row_number)!=(t==null?void 0:t.name)&&(this.place=null)},place(t){t?(this.form.place_id=t.id,this.row={name:t.row_number},this.updateNextandPrevious()):this.form.place_id=null}},mounted(){var t;if(localStorage.getItem("locationData"))try{this.locationData=JSON.parse(localStorage.getItem("locationData"))}catch{localStorage.removeItem("locationData")}if(this.inventory.type=="group"&&(this.locationData.autoLocate=!1),this.locationData.autoLocate&&this.inventory.id!=localStorage.lastInventoryId){const e=this.locationData;e.autoLocateToNext?e.nextPlace?(this.assignBlock(e.nextPlace),this.$nextTick(()=>{new Promise(n=>{setTimeout(()=>{this.assignNextPlace(e.nextPlace),n()},50)}).then(()=>{this.makeAutoLocateNotice(!0,`Autolocated to next place: row# ${this.place.row_number}, plant# ${this.place.plant_number}`)})})):(this.makeAutoLocateNotice(!1,"Was not autolocated. No more places in current row."),this.locationData.autoLocate=!1):e.previousPlace?(this.assignBlock(e.previousPlace),this.$nextTick(()=>{new Promise(n=>{setTimeout(()=>{this.assignNextPlace(e.previousPlace),n()},50)}).then(()=>{this.makeAutoLocateNotice(!0,`Autolocated to previous place: Row# ${this.place.row_number}, Plant# ${this.place.plant_number}`)})})):(this.makeAutoLocateNotice(!1,"Was not autolocated. Reached first place in current row."),this.locationData.autoLocate=!1)}(t=this.selectedBlock)!=null&&t.has_places&&this.getPlaces(this.selectedBlock)},emits:["autolocated"],computed:{rows(){return[...new Set(this.places.map(t=>t.row_number))].map(t=>{let e={};return e.name=t,e})},rowPlantNumbers(){if(this.places.length&&this.row)return this.places.filter(t=>t.row_number==this.row.name)},autolocateLabel(){return this.locationData.autoLocate?this.locationData.autoLocateToNext?this.locationData.nextPlace?`Autolocate to Row: ${this.locationData.nextPlace.row_number}, Plant: ${this.locationData.nextPlace.plant_number}`:"Reached last place in row.":this.locationData.previousPlace?`Autolocate to Row: ${this.locationData.previousPlace.row_number}, Plant: ${this.locationData.previousPlace.plant_number}`:"Reached first place in row.":"Autolocate?"}},methods:{updateNextandPrevious(){this.place&&(this.locationData.previousPlace=this.places.filter(t=>t.plant_number===this.place.plant_number-1&&t.row_number===this.place.row_number)[0],this.locationData.nextPlace=this.places.filter(t=>t.plant_number===this.place.plant_number+1&&t.row_number===this.place.row_number)[0])},assignNextPlace(t){t&&(this.place=t),this.$nextTick(()=>{this.updateInventoryLocation()}),this.autoLocateNotice.message=null,this.$emit("autolocated",this.autoLocateNotice)},assignBlock(t){this.selectedBlock=this.blocks.find(e=>e.id=t.block_id)},makeAutoLocateNotice(t,e){this.autoLocateNotice={wasAutoLocated:t,message:e},this.$emit("autolocated",this.autoLocateNotice)},confirm(){this.form.confirm_replace=!0,this.confirmingReplace=!1,this.form.clearErrors(),this.updateInventoryLocation()},dontConfirm(){this.autoLocateNotice.message=null,this.confirmingReplace=!1,this.form.clearErrors(),this.$inertia.reload()},updateInventoryLocation(){this.form.patch(route("inventory.update",this.inventory),{onSuccess:t=>{this.editingInventoryLocation=!1,this.form.confirm_replace=null},onError:t=>{t.confirm_replace&&(this.editingInventoryLocation=!1,this.confirmingReplace=!0)}})},getPlaces(t){this.loading=!0,axios.get(route("api.places.index",t),{Headers:{"Cache-Control":"cache"}}).then(e=>{this.places=e.data,this.loading=!1,this.updateNextandPrevious()}).catch(e=>{console.error(e.message)})}}},$={class:"py-4 grid gap-4"},ee={class:"flex flex-wrap items-center justify-between"},te=l("h2",{class:"text-xl"},"Inventory Location",-1),oe=c(" Edit"),ne={key:0},ae={key:1,class:"text-red-500"},ie={key:2,class:"text-red-500"},se={key:3},le={key:0,class:"grid gap-4"},ce={key:0,class:"flex items-center justify-between space-x-2 w-full"},re=c(" Previous"),ue=c("Next"),de={key:1,class:"flex space-between-4 items-center"},me=c("Autolocate to previous "),he=c("Autolocate to next "),pe=c("There is another item in this place. Are you sure you want to replace that item?"),_e=c("The inventory item located in this place will be given an unnasigned location."),fe={class:"flex justify-between items-center w-full"},ve=c("No, Nevermind"),ge=c("Yes, I'm sure"),ke=c("Edit Inventory Location"),be=c(" Update this inventory location."),ye={class:"col-span-6 grid gap-4"},we={class:"grid gap-4 sm:grid-cols-2"},xe={class:"sm:col-span-2"},Le={key:0},Ne={key:0,class:"grid gap-4 sm:grid-cols-2"},Pe={class:"sm:col-span-1"},Ie={class:"sm:col-span-1"},De={key:1,class:"text-sm"},Ce={class:"flex justify-between items-center w-full"},Be=c("Cancel"),Ve=c("Save Location");function je(t,e,n,Je,o,r){const P=d("EditIcon"),_=d("jet-button"),I=d("ChevronLeftIcon"),D=d("ChevronRightIcon"),C=d("jet-checkbox"),v=d("jet-label"),y=d("jet-secondary-button"),B=d("jet-confirmation-modal"),g=d("select-box"),k=d("jet-input-error"),V=d("jet-dialog-modal");return s(),m("div",$,[l("div",ee,[te,a(_,{onClick:e[0]||(e[0]=u=>o.editingInventoryLocation=!0),class:"ml-auto pl-2"},{default:i(()=>[a(P,{class:"w-4 h-4 mr-2"}),oe]),_:1})]),n.inventory.block?(s(),m("p",ne,"Block: "+f(n.inventory.block.name),1)):(s(),m("p",ae,"Location Unasigned!")),n.inventory.block&&n.inventory.block.has_places&&!n.inventory.place&&n.inventory.type!="group"?(s(),m("p",ie," Place Unasigned! ")):p("",!0),n.inventory.type!="group"?(s(),m("div",se,[n.inventory.block&&n.inventory.place?(s(),m("div",le,[l("p",null," Place: Row number: "+f(n.inventory.place.row_number)+" Plant Number: "+f(n.inventory.place.plant_number),1),n.inventory.block&&n.inventory.place?(s(),m("div",ce,[a(_,{disabled:!o.locationData.previousPlace,onClick:e[1]||(e[1]=u=>r.assignNextPlace(o.locationData.previousPlace)),class:"flex-shrink-0 pl-2"},{default:i(()=>[a(I,{class:"w-4 h-4 mr-2"}),re]),_:1},8,["disabled"]),a(_,{disabled:!o.locationData.nextPlace,onClick:e[2]||(e[2]=u=>r.assignNextPlace(o.locationData.nextPlace)),class:"flex-shrink-0 pr-2"},{default:i(()=>[ue,a(D,{class:"w-4 h-4 ml-2"})]),_:1},8,["disabled"])])):p("",!0),a(v,{class:"text-lg"},{default:i(()=>[c(f(r.autolocateLabel)+" ",1),a(C,{checked:o.locationData.autoLocate,modelValue:o.locationData.autoLocate,"onUpdate:modelValue":e[3]||(e[3]=u=>o.locationData.autoLocate=u),class:"ml-2"},null,8,["checked","modelValue"])]),_:1}),o.locationData.autoLocate?(s(),m("div",de,[a(v,null,{default:i(()=>[me,w(l("input",{type:"radio",value:!1,"onUpdate:modelValue":e[4]||(e[4]=u=>o.locationData.autoLocateToNext=u),class:"ml-2 border-gray-300 shadow-sm focus:border-none focus:ring-1 focus:ring-current focus:ring-opacity-50 cursor-pointer text-green-600"},null,512),[[x,o.locationData.autoLocateToNext]])]),_:1}),a(v,null,{default:i(()=>[he,w(l("input",{type:"radio",value:!0,"onUpdate:modelValue":e[5]||(e[5]=u=>o.locationData.autoLocateToNext=u),class:"ml-2 border-gray-300 shadow-sm focus:border-none focus:ring-1 focus:ring-current focus:ring-opacity-50 cursor-pointer text-green-600"},null,512),[[x,o.locationData.autoLocateToNext]])]),_:1})])):p("",!0)])):p("",!0)])):p("",!0),a(B,{show:o.confirmingReplace,onClose:r.dontConfirm},{title:i(()=>[pe]),content:i(()=>[_e]),footer:i(()=>[l("div",fe,[a(y,{onClick:r.dontConfirm},{default:i(()=>[ve]),_:1},8,["onClick"]),a(_,{onClick:r.confirm,class:L({"opacity-25":o.form.processing}),disabled:o.form.processing},{default:i(()=>[ge]),_:1},8,["onClick","class","disabled"])])]),_:1},8,["show","onClose"]),a(V,{show:o.editingInventoryLocation,onClose:e[12]||(e[12]=u=>o.editingInventoryLocation=!1)},{title:i(()=>[ke]),description:i(()=>[be]),content:i(()=>{var u;return[l("form",{onSubmit:e[9]||(e[9]=J((...h)=>r.updateInventoryLocation&&r.updateInventoryLocation(...h),["prevent"])),onKeydown:e[10]||(e[10]=R((...h)=>r.updateInventoryLocation&&r.updateInventoryLocation(...h),["enter"]))},[l("div",ye,[l("div",we,[l("div",xe,[a(g,{labelValue:"Block Location",items:o.blocks,selectedItem:o.selectedBlock,modelValue:o.selectedBlock,"onUpdate:modelValue":e[6]||(e[6]=h=>o.selectedBlock=h)},null,8,["items","selectedItem","modelValue"]),o.form.block_id?p("",!0):(s(),b(k,{key:0,message:o.form.errors.block_id,class:"mt-2"},null,8,["message"]))])]),((u=o.selectedBlock)==null?void 0:u.has_places)&&n.inventory.type!="group"?(s(),m("div",Le,[o.loading?(s(),m("div",De,"Loading Places...")):(s(),m("div",Ne,[l("div",Pe,[a(g,{labelValue:"Row Number",items:r.rows,selectedItem:o.row,modelValue:o.row,"onUpdate:modelValue":e[7]||(e[7]=h=>o.row=h)},null,8,["items","selectedItem","modelValue"]),o.form.block_id?p("",!0):(s(),b(k,{key:0,message:o.form.errors.block_id,class:"mt-2"},null,8,["message"]))]),l("div",Ie,[a(g,{labelValue:"Plant Number",items:r.rowPlantNumbers,selectedItem:o.place,modelValue:o.place,"onUpdate:modelValue":e[8]||(e[8]=h=>o.place=h),nameValue:"plant_number"},null,8,["items","selectedItem","modelValue"]),o.form.block_id?p("",!0):(s(),b(k,{key:0,message:o.form.errors.block_id,class:"mt-2"},null,8,["message"]))])]))])):p("",!0)])],32)]}),footer:i(()=>[l("div",Ce,[a(y,{type:"button",onClick:e[11]||(e[11]=u=>o.editingInventoryLocation=!1)},{default:i(()=>[Be]),_:1}),l("div",null,[a(_,{type:"submit",onClick:r.updateInventoryLocation,class:L({"opacity-25":o.form.processing}),disabled:o.form.processing},{default:i(()=>[Ve]),_:1},8,["onClick","class","disabled"])])])]),_:1},8,["show"])])}var Qe=W(Z,[["render",je]]);export{Qe as default};
