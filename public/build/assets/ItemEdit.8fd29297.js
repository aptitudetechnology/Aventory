import{J as V}from"./DialogModal.ea7b6519.js";import{J as z}from"./ActionMessage.5ee845ce.js";import{E as q}from"./EditButton.fc6d3f94.js";import C from"./ProductHoldView.43827e13.js";import{_ as Q,ap as j,r as s,o as O,J as k,b as o,w as d,O as p,Q as x,U,a as l,a8 as D,L as F,d as c}from"./app.fa9cc1ae.js";import E from"./InventoryDetail.2967204e.js";import B from"./ItemConfirmQuantity.d380ba6c.js";import{S as J,a as M,b as L,c as A}from"./switch.esm.a7d5a89c.js";import"./Modal.66389f43.js";import"./PencilIcon.8057c110.js";import"./TabLink.82ecb71e.js";import"./ErrorMessage.7df8a495.js";import"./XCircleIcon.0d2fb5b2.js";import"./ProductHoldItem.9b776b4d.js";import"./SmallLineItem.42594acd.js";import"./LoadingState.61e0e8d4.js";import"./ConfirmationModal.2e591634.js";import"./description.esm.1831666a.js";import"./label.esm.1dccfab2.js";const N={components:{Switch:J,SwitchDescription:M,SwitchGroup:L,SwitchLabel:A,JetDialogModal:V,JetActionMessage:z,EditButton:q,ProductHoldView:C,MoneyInput:j,InventoryDetail:E,ItemConfirmQuantity:B},props:{orderItem:Object,editing:{type:Boolean,default:!1}},data(){var r,t;return{priceLevelId:(t=(r=this.$page.props.order)==null?void 0:r.customer)==null?void 0:t.customer_price_level_id,products:this.$page.props.products,sizes:this.$page.props.sizes,selectedProduct:this.$page.props.products.find(u=>u.id==this.orderItem.product_id),selectedSize:this.$page.props.sizes.find(u=>u.id==this.orderItem.size_id),updatingOrderItem:this.editing,confirmedQuantity:!1,confirmingQuantity:!1,availableForSale:0,form:this.$inertia.form(this.orderItem)}},watch:{editing(){this.updatingOrderItem=this.editing},selectedProduct(){this.selectedProduct?this.form.product_id=this.selectedProduct.id:this.form.product_id=null,this.getProductPrice()},selectedSize(r){r?this.form.size_id=r.id:this.form.size_id=null,this.getProductPrice()}},methods:{getProductPrice(){this.selectedProduct&&this.selectedSize?axios.get(route("api.product.prices",[this.selectedProduct.id,this.selectedSize.id])).then(r=>{let t=r.data.find(u=>u.price_level_id==this.priceLevelId).price;this.form.unit_price=t}):this.form.unit_price=0},updateQuantity(r){this.availableForSale=r.availableForSale},viewInventory(r){this.showPopup(route("view.show",{id:r.id}),"View Inventory")},closeForm(){this.updatingOrderItem=!1,this.$emit("close")},updateOrderItem(){this.form.quantity-this.orderItem.quantity>this.availableForSale?this.confirmingQuantity=!0:this.confirmed()},confirmed(){this.confirmingQuantity=!1,this.confirmedQuantity=!0,this.update()},update(){this.confirmedQuantity&&this.form.patch(route("sales.order-items.update",[this.orderItem.order_id,this.orderItem.id]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{this.confirmedQuantity=!1,this.updatingOrderItem=!1,this.$emit("close"),this.$inertia.visit(route("orders.show",[this.orderItem.order_id]),{preserveScroll:!0})}})}}},K=c("Edit"),G=c("Edit"),H=c("View Inventory"),T=c(" Edit Item"),W={class:"grid md:grid-cols-6 gap-4"},R={class:"grid gap-4"},X={class:"grid gap-4 sm:grid-cols-2 items-center"},Y={class:"sm:col-span-2 min-w-0"},Z={class:"flex items-center mt-4"},$=c("Don't apply Discount?"),ee={class:"grid gap-4 grid-cols-1 sm:grid-cols-3"},te={class:"flex justify-between w-full"},oe=c("Cancel"),ie=c("Save Item");function se(r,t,u,re,e,n){const y=s("edit-button"),_=s("jet-button"),f=s("select-box"),m=s("jet-input-error"),g=s("jet-checkbox"),a=s("jet-label"),v=s("InventoryDetail"),h=s("jet-input"),I=s("money-input"),b=s("product-hold-view"),w=s("jet-secondary-button"),S=s("jet-dialog-modal"),P=s("ItemConfirmQuantity");return O(),k("div",null,[o(y,{type:"button",onClick:t[0]||(t[0]=p(i=>e.updatingOrderItem=!0,["stop"]))},{default:d(()=>[K]),_:1}),o(S,{show:e.updatingOrderItem,maxWidth:"4xl",onClose:n.closeForm},{title:d(()=>[G]),aside:d(()=>[x(o(_,{onClick:t[1]||(t[1]=p(i=>n.viewInventory(e.selectedProduct),["stop"]))},{default:d(()=>[H]),_:1},512),[[U,e.selectedProduct]])]),description:d(()=>[T]),content:d(()=>[l("div",W,[l("form",{onSubmit:t[8]||(t[8]=p((...i)=>n.updateOrderItem&&n.updateOrderItem(...i),["prevent"])),onKeydown:t[9]||(t[9]=D((...i)=>n.updateOrderItem&&n.updateOrderItem(...i),["enter"])),class:"md:col-span-4"},[l("div",R,[l("div",X,[l("div",Y,[o(f,{labelValue:"Product",items:e.products,selectedItem:e.selectedProduct,modelValue:e.selectedProduct,"onUpdate:modelValue":t[2]||(t[2]=i=>e.selectedProduct=i)},null,8,["items","selectedItem","modelValue"]),o(m,{message:e.form.errors.product_id,class:"mt-2"},null,8,["message"])]),l("div",null,[o(f,{labelValue:"Size",items:e.sizes,selectedItem:e.selectedSize,modelValue:e.selectedSize,"onUpdate:modelValue":t[3]||(t[3]=i=>e.selectedSize=i)},null,8,["items","selectedItem","modelValue"]),o(m,{message:e.form.errors.size_id,class:"mt-2"},null,8,["message"]),l("div",Z,[o(g,{id:"no_discount",modelValue:e.form.no_discount,"onUpdate:modelValue":t[4]||(t[4]=i=>e.form.no_discount=i),class:"mr-2",checked:e.form.no_discount},null,8,["modelValue","checked"]),o(a,{for:"no_discount"},{default:d(()=>[$]),_:1})])]),o(v,{onUpdate:n.updateQuantity,product:e.selectedProduct,size:e.selectedSize},null,8,["onUpdate","product","size"])]),l("div",ee,[l("div",null,[o(a,{for:"original_quantity",value:"Quantity Ordered"}),o(h,{id:"original_quantity",type:"number",step:"1",class:"mt-1 block w-full",modelValue:e.form.original_quantity,"onUpdate:modelValue":t[5]||(t[5]=i=>e.form.original_quantity=i),required:""},null,8,["modelValue"]),o(m,{message:e.form.errors.original_quantity,class:"mt-2"},null,8,["message"])]),l("div",null,[o(a,{for:"quantity",value:"Quantity Confirmed"}),o(h,{id:"quantity",type:"number",step:"1",class:"mt-1 block w-full",modelValue:e.form.quantity,"onUpdate:modelValue":t[6]||(t[6]=i=>e.form.quantity=i),modelModifiers:{number:!0},required:""},null,8,["modelValue"]),o(m,{message:e.form.errors.quantity,class:"mt-2"},null,8,["message"])]),l("div",null,[o(a,{for:"unit_price",value:"Unit Price"}),o(I,{id:"unit_price",class:"mt-1 block w-full",required:"",modelValue:e.form.unit_price,"onUpdate:modelValue":t[7]||(t[7]=i=>e.form.unit_price=i)},null,8,["modelValue"]),o(m,{message:e.form.errors.unit_price,class:"mt-2"},null,8,["message"])])])])],32),o(b,{class:"md:col-span-2",orderId:u.orderItem.order_id,product:e.selectedProduct,size:e.selectedSize},null,8,["orderId","product","size"])])]),footer:d(()=>[l("div",te,[o(w,{type:"button",onClick:n.closeForm},{default:d(()=>[oe]),_:1},8,["onClick"]),o(_,{type:"submit",onClick:n.updateOrderItem,class:F({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:d(()=>[ie]),_:1},8,["onClick","class","disabled"])])]),_:1},8,["show","onClose"]),o(P,{selectedProduct:e.selectedProduct,quantity:e.form.quantity,quantityAvailable:e.availableForSale,show:e.confirmingQuantity,onQuantityConfirmed:n.confirmed},null,8,["selectedProduct","quantity","quantityAvailable","show","onQuantityConfirmed"])])}var Ve=Q(N,[["render",se]]);export{Ve as default};
